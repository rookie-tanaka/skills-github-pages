<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
	<title>å±•è¦§ä¼šã‚µãƒ³ãƒ—ãƒ« - ãƒ¢ãƒ¼ãƒ€ãƒ«è¡¨ç¤º</title>
	<meta name="description" content="360Â° Image - A-Frame">
	<script src="https://aframe.io/releases/1.7.0/aframe.min.js"></script>
	<link rel="preconnect" href="https://fonts.googleapis.com">
	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link href="https://fonts.googleapis.com/css2?family=Zen+Old+Mincho:wght@400;900&display=swap" rel="stylesheet">
	<style>
	body {
		margin: 0;
		font-family: 'Zen Old Mincho', serif;
		color: #434343;
	}
	.modal {
		display: none;
		position: fixed;
		z-index: 1000;
		left: 0;
		top: 0;
		width: 100%;
		height: 100%;
		padding: 20px;
		box-sizing: border-box;
		/* ãƒ¢ãƒ¼ãƒ€ãƒ«ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ */
		transition: all 0.3s ease;
		opacity: 0;
		/* èƒŒæ™¯ãƒ–ãƒ©ãƒ¼ã‚¨ãƒ•ã‚§ã‚¯ãƒˆ */
		backdrop-filter: blur(8px);
		-webkit-backdrop-filter: blur(8px);
	}
	.modal.show {
		display: flex;
		/* Flexboxã§ä¸Šä¸‹ä¸­å¤®å¯„ã› */
		align-items: center;
		justify-content: center;
		opacity: 1;
	}
	
	/* A-Frameã‚·ãƒ¼ãƒ³ã®ãƒ–ãƒ©ãƒ¼ã‚¨ãƒ•ã‚§ã‚¯ãƒˆ */
	a-scene.modal-blur {
		filter: blur(5px);
		-webkit-filter: blur(5px);
		transition: filter 0.3s ease;
		-webkit-transition: -webkit-filter 0.3s ease;
		transform: scale(1.02);
	}
	.modal-content {
		background-color: #fefefe;
		margin: 0;
		padding: 20px;
		border-radius: 10px;
		width: 90%;
		max-width: 800px;
		max-height: 90vh;
		text-align: center;
		overflow-y: auto;
		position: relative;
		box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
	}
	.modal-image {
		max-width: 100%;
		max-height: 70vh;
		object-fit: contain;
	}
	.close {
		color: #aaa;
		float: right;
		font-size: 28px;
		cursor: pointer;
		position: absolute;
		right: 20px;
		top: 10px;
	}
	.close:hover,
	.close:focus {
		color: #000;
		text-decoration: none;
	}
	.image-title {
		font-weight: 900;
		font-size: 1.8em;
		margin: 15px 0;
		color: #333;
	}
	
	/* Infoåˆ‡ã‚Šæ›¿ãˆUIç”¨ã®ã‚¹ã‚¿ã‚¤ãƒ« */
	.info-toggle-container {
		position: fixed;
		bottom: 30px;
		left: 30px;
		z-index: 500;
		font-family: 'Arial', sans-serif;
	}
	
	.info-toggle-button {
		background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
		border: none;
		border-radius: 50px;
		padding: 15px 25px;
		color: white;
		font-size: 16px;
		font-weight: bold;
		cursor: pointer;
		box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
		transition: all 0.3s ease;
		display: flex;
		align-items: center;
		gap: 10px;
		min-width: 120px;
		justify-content: center;
	}
	
	.info-toggle-button:hover {
		transform: translateY(-2px);
		box-shadow: 0 6px 20px rgba(0, 0, 0, 0.3);
		background: linear-gradient(135deg, #764ba2 0%, #667eea 100%);
	}
	
	.info-toggle-button:active {
		transform: translateY(0);
		box-shadow: 0 2px 10px rgba(0, 0, 0, 0.2);
	}
	
	.info-toggle-button.hidden {
		background: linear-gradient(135deg, #95a5a6 0%, #7f8c8d 100%);
	}
	
	.info-toggle-button.hidden:hover {
		background: linear-gradient(135deg, #7f8c8d 0%, #95a5a6 100%);
	}
	
	.toggle-icon {
		font-size: 20px;
		transition: transform 0.3s ease;
	}
	
	.info-toggle-button.hidden .toggle-icon {
		transform: rotate(360deg);
	}
	
	/* è¨­å®šãƒ‘ãƒãƒ« */
	.settings-panel {
		position: fixed;
		bottom: 180px;
		left: 30px;
		background: rgba(255, 255, 255, 0.95);
		padding: 15px;
		border-radius: 15px;
		font-size: 12px;
		color: #333;
		box-shadow: 0 4px 20px rgba(0, 0, 0, 0.15);
		transition: all 0.3s ease;
		z-index: 500;
		opacity: 0;
		transform: translateY(20px);
		pointer-events: none;
		max-width: 200px;
	}
	
	.settings-panel.show {
		opacity: 1;
		transform: translateY(0);
		pointer-events: auto;
	}
	
	.settings-option {
		margin: 8px 0;
		display: flex;
		align-items: center;
		gap: 8px;
	}
	
	.settings-option input[type="checkbox"] {
		width: 16px;
		height: 16px;
		cursor: pointer;
	}
	
	.settings-option label {
		cursor: pointer;
		user-select: none;
	}
	
	/* ãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ–å¯¾å¿œ */
	@media (max-width: 768px) {
		.info-toggle-container {
			bottom: 20px;
			left: 20px;
		}
		
		.info-toggle-button {
			padding: 12px 20px;
			font-size: 14px;
			min-width: 100px;
		}
	
		
		.settings-panel {
			bottom: 140px;
			left: 20px;
			max-width: 180px;
		}
	}
	</style>
</head>
<body>
	<a-scene cursor="rayOrigin: mouse" vr-mode-ui="enabled: false">
		<a-sky src="./img/panorama.webp" rotation="0 -180 0"></a-sky>
		
		<!-- ç§»å‹•ç„¡åŠ¹åŒ–ã—ãŸã‚«ãƒ¡ãƒ© -->
		<a-camera look-controls="enabled: true" wasd-controls="enabled: false" position="0 0 0"></a-camera>
		
		<!-- Info ã‚¢ã‚¤ã‚³ãƒ³ã‚’ã‚°ãƒ«ãƒ¼ãƒ—åŒ– -->
		<a-entity id="infoGroup">
			<a-image width="4" height="4" rotation="0 0 0" position="21.523 -5.617 -34.486" 
				src="./img/circle-info-solid.png" 
				image_viewer="imageId: 01"
				class="info-icon"
				data-artwork-name="ãƒ«ãƒ¼ãƒ´ã‚·ã‚¨ãƒ³ãƒŒã®é“"></a-image>
			
			<a-image width="4" height="4" rotation="0 -90 0" position="28.000 -5.468 -26.822" 
				src="./img/circle-info-solid.png" 
				image_viewer="imageId: 02"
				class="info-icon"
				data-artwork-name="ãƒ´ã‚£ãƒ«ãƒŒãƒ¼ãƒ´ï¼ãƒ©ï¼ã‚¬ãƒ¬ãƒ³ãƒŒã®æ©‹"></a-image>
			
			<a-image width="4" height="4" rotation="0 -90 0" position="28.595 -5.612 -15.343" 
				src="./img/circle-info-solid.png" 
				image_viewer="imageId: 03"
				class="info-icon"
				data-artwork-name="ãƒãƒ¼ãƒ«ãƒ»ãƒãƒ«ã‚Šãƒ¼ã®æ´ªæ°´"></a-image>
			
			<a-image width="4" height="4" rotation="0 -90 0" position="30.000 -5.764 -3.573" 
				src="./img/circle-info-solid.png" 
				image_viewer="imageId: 04"
				class="info-icon"
				data-artwork-name="æ˜¥ã®å¤ªé™½â”€ãƒ­ãƒ¯ãƒ³æ²³"></a-image>
			
			<a-image width="4" height="4" rotation="0 -90 0" position="29.241 -9.958 4.613" 
				src="./img/circle-info-solid.png" 
				image_viewer="imageId: 05"
				class="info-icon"
				data-artwork-name="ãƒ¢ãƒ¬ã®æ•™ä¼šå ‚"></a-image>

			<a-image width="4" height="4" rotation="0 90 0" position="-29.241 -9.958 5.891"
				src="./img/circle-info-solid.png" 
				image_viewer="imageId: 06"
				class="info-icon"
				data-artwork-name="ãƒ«ãƒ¼ãƒ´ã‚·ã‚¨ãƒ³ãƒŒã®é›ª"></a-image>

			<a-image width="4" height="4" rotation="0 90 0" position="-30.000 -6.245 -3.973"
				src="./img/circle-info-solid.png" 
				image_viewer="imageId: 07"
				class="info-icon"
				data-artwork-name="æ£®æ—ã€ã¾ã‚ã‚Šã®é¢¨æ™¯"></a-image>

			<a-image width="4" height="4" rotation="0 90 0" position="-28.595 -5.919 -16.733"
				src="./img/circle-info-solid.png" 
				image_viewer="imageId: 08"
				class="info-icon"
				data-artwork-name="ãƒ«ãƒ¼ãƒ´ã‚·ã‚¨ãƒ³ãƒŒã®é›ªåŠ¹æœ"></a-image>

			<a-image width="4" height="4" rotation="0 90 0" position="-28.000 -5.803 -29.210"
				src="./img/circle-info-solid.png" 
				image_viewer="imageId: 09"
				class="info-icon"
				data-artwork-name="ã‚µãƒ³ï¼ãƒãƒ¡ã‚¹ã®ãƒ­ãƒ¯ãƒ³æ²³"></a-image>
				
			<a-image width="4" height="4" rotation="0 0 0" position="-18.782 -5.468 -34.476"
				src="./img/circle-info-solid.png" 
				image_viewer="imageId: 10"
				class="info-icon"
				data-artwork-name="ãƒãƒ³ãƒ—ãƒˆãƒ³ã‚³ãƒ¼ãƒˆã®ãƒ†ãƒ ã‚ºå·"></a-image>
		</a-entity>
	</a-scene>

	<!-- Infoåˆ‡ã‚Šæ›¿ãˆUI -->
	<div class="info-toggle-container">
		<button id="infoToggleButton" class="info-toggle-button" onclick="toggleInfoDisplay()">
			<span class="toggle-icon">ğŸ™‚</span>
			<span id="toggleButtonText">è¡¨ç¤º</span>
		</button>
	</div>

	<!-- è¨­å®šãƒ‘ãƒãƒ« -->
	<div id="settingsPanel" class="settings-panel">
		<div class="settings-option">
			<input type="checkbox" id="autoHideStatus" checked>
			<label for="autoHideStatus">è‡ªå‹•ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹éè¡¨ç¤º</label>
		</div>
		<div class="settings-option">
			<input type="checkbox" id="smoothAnimation" checked>
			<label for="smoothAnimation">ã‚¹ãƒ ãƒ¼ã‚ºã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³</label>
		</div>
		<div class="settings-option">
			<input type="checkbox" id="showInfoCount" checked>
			<label for="showInfoCount">ä½œå“æ•°è¡¨ç¤º</label>
		</div>
	</div>

	<!-- ãƒ¢ãƒ¼ãƒ€ãƒ«ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ -->
	<div id="imageModal" class="modal">
		<div class="modal-content">
			<span class="close" id="closeModal">&times;</span>
			<h2 class="image-title" id="imageTitle">ä½œå“ã‚¿ã‚¤ãƒˆãƒ«</h2>
			<img id="modalImage" class="modal-image" src="" alt="ä½œå“ç”»åƒ">
			<p id="imageDescription">ä½œå“ã®èª¬æ˜ãŒã“ã“ã«è¡¨ç¤ºã•ã‚Œã¾ã™ã€‚</p>
		</div>
	</div>

<script>
// ã‚°ãƒ­ãƒ¼ãƒãƒ«å¤‰æ•°
let infoVisible = true;
let statusTimeout = null;
let settingsVisible = false;

// ç”»åƒè¡¨ç¤ºç”¨ã®A-Frameã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
AFRAME.registerComponent('image_viewer', {
	schema: {
		imageId: {type: 'string', default: '01'}
	},

	init: function () {
		let data = this.data;
		let modal = document.getElementById('imageModal');
		let modalImage = document.getElementById('modalImage');
		let imageTitle = document.getElementById('imageTitle');
		let imageDescription = document.getElementById('imageDescription');
		
		// ç”»åƒæƒ…å ±ã®ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹
		const imageInfo = {
			'01': {title: 'ãƒ«ãƒ¼ãƒ´ã‚·ã‚¨ãƒ³ãƒŒã®é“', description: '1876å¹´'},
			'02': {title: 'ãƒ´ã‚£ãƒ«ãƒŒãƒ¼ãƒ´ï¼ãƒ©ï¼ã‚¬ãƒ¬ãƒ³ãƒŒã®æ©‹', description: '1872å¹´'},
			'03': {title: 'ãƒãƒ¼ãƒ«ãƒ»ãƒãƒ«ãƒªãƒ¼ã®æ´ªæ°´', description: '1987å¹´'},
			'04': {title: 'æ˜¥ã®å¤ªé™½â”€ãƒ­ãƒ¯ãƒ³æ²³', description: '1892å¹´'},
			'05': {title: 'ãƒ¢ãƒ¬ã®æ•™ä¼šå ‚', description: '1894å¹´'},
			'06': {title: 'ãƒ«ãƒ¼ãƒ´ã‚·ã‚¨ãƒ³ãƒŒã®é›ª', description: '1878å¹´'},
			'07': {title: 'æ£®æ—ã€ã¾ã‚ã‚Šã®é¢¨æ™¯', description: '1895å¹´'},
			'08': {title: 'ãƒ«ãƒ¼ãƒ´ã‚·ã‚¨ãƒ³ãƒŒã®é›ªåŠ¹æœ', description: '1874å¹´'},
			'09': {title: 'ã‚µãƒ³ï¼ãƒãƒ¡ã‚¹ã®ãƒ­ãƒ¯ãƒ³æ²³', description: '1874å¹´'},
			'10': {title: 'ãƒãƒ³ãƒ—ãƒˆãƒ³ã‚³ãƒ¼ãƒˆã®ãƒ†ãƒ ã‚ºå·', description: '1874å¹´'}
		};

		this.el.addEventListener('click', function () {
			const info = imageInfo[data.imageId] || {title: 'ä½œå“', description: 'èª¬æ˜ãªã—'};
			modalImage.src = `./img/${data.imageId}.webp`;
			imageTitle.textContent = info.title;
			imageDescription.textContent = info.description;
			
			// A-Frameã‚·ãƒ¼ãƒ³ã«ãƒ–ãƒ©ãƒ¼ã‚¨ãƒ•ã‚§ã‚¯ãƒˆã‚’é©ç”¨
			const scene = document.querySelector('a-scene');
			scene.classList.add('modal-blur');
			
			// Flexboxã§ä¸­å¤®å¯„ã›è¡¨ç¤º
			modal.style.display = 'flex';
			modal.classList.add('show');
		});
	}
});

// Infoè¡¨ç¤ºåˆ‡ã‚Šæ›¿ãˆé–¢æ•°
function toggleInfoDisplay() {
	const infoGroup = document.getElementById('infoGroup');
	const toggleButton = document.getElementById('infoToggleButton');
	const toggleButtonText = document.getElementById('toggleButtonText');
	const toggleIcon = document.querySelector('.toggle-icon');
	const smoothAnimation = document.getElementById('smoothAnimation').checked;
	
	infoVisible = !infoVisible;
	
	if (smoothAnimation) {
		// ã‚¹ãƒ ãƒ¼ã‚ºã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³
		if (infoVisible) {
			infoGroup.setAttribute('animation', 'property: visible; to: true; dur: 0');
			infoGroup.setAttribute('animation__fade', 'property: opacity; from: 0; to: 1; dur: 500');
			infoGroup.object3D.visible = true;
		} else {
			infoGroup.setAttribute('animation__fade', 'property: opacity; from: 1; to: 0; dur: 500');
			setTimeout(() => {
				infoGroup.object3D.visible = false;
			}, 500);
		}
	} else {
		// å³åº§ã«åˆ‡ã‚Šæ›¿ãˆ
		infoGroup.object3D.visible = infoVisible;
	}
	
	// ãƒœã‚¿ãƒ³ã®è¡¨ç¤ºæ›´æ–°
	if (infoVisible) {
		toggleButton.classList.remove('hidden');
		toggleButtonText.textContent = 'è¡¨ç¤º';
		toggleIcon.textContent = 'ğŸ™‚';
	} else {
		toggleButton.classList.add('hidden');
		toggleButtonText.textContent = 'éè¡¨ç¤º';
		toggleIcon.textContent = 'ğŸ˜';
	}
	
	// ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹æ›´æ–°
	updateStatus();
	
	console.log(`Infoè¡¨ç¤º: ${infoVisible ? 'æœ‰åŠ¹' : 'ç„¡åŠ¹'}`);
}

// ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹è¡¨ç¤ºæ›´æ–°
function updateStatus() {
	const statusText = document.getElementById('statusText');
	const infoStatus = document.getElementById('infoStatus');
	const showInfoCount = document.getElementById('showInfoCount').checked;
	const infoIcons = document.querySelectorAll('.info-icon');
	
	const countText = showInfoCount ? ` (${infoIcons.length}å€‹)` : '';
	const statusMessage = infoVisible ? 
		`ä½œå“æƒ…å ±: è¡¨ç¤ºä¸­${countText}` : 
		`ä½œå“æƒ…å ±: éè¡¨ç¤º${countText}`;
	
	statusText.textContent = statusMessage;
	
	// ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã®è‰²å¤‰æ›´
	if (infoVisible) {
		infoStatus.classList.remove('hidden');
		infoStatus.classList.add('visible');
	} else {
		infoStatus.classList.remove('visible');
		infoStatus.classList.add('hidden');
	}
}

// åˆæœŸåŒ–
document.addEventListener('DOMContentLoaded', function() {
	updateStatus();
	
	console.log('Infoåˆ‡ã‚Šæ›¿ãˆUIåˆæœŸåŒ–å®Œäº†');
	console.log('æ“ä½œæ–¹æ³•:');
	console.log('- ãƒœã‚¿ãƒ³ã‚¯ãƒªãƒƒã‚¯: Infoè¡¨ç¤º/éè¡¨ç¤ºåˆ‡ã‚Šæ›¿ãˆã®ã¿');
	console.log('- ã‚«ãƒ¡ãƒ©ç§»å‹•: ç„¡åŠ¹åŒ–ï¼ˆè¦–ç‚¹å›è»¢ã®ã¿å¯èƒ½ï¼‰');
});

// ãƒ¢ãƒ¼ãƒ€ãƒ«ã‚’é–‰ã˜ã‚‹å‡¦ç†
document.getElementById('closeModal').addEventListener('click', function() {
	const modal = document.getElementById('imageModal');
	const scene = document.querySelector('a-scene');
	
	// ãƒ–ãƒ©ãƒ¼ã‚¨ãƒ•ã‚§ã‚¯ãƒˆã‚’å‰Šé™¤
	scene.classList.remove('modal-blur');
	
	// ãƒ¢ãƒ¼ãƒ€ãƒ«ã‚’é–‰ã˜ã‚‹
	modal.style.display = 'none';
	modal.classList.remove('show');
});

// ãƒ¢ãƒ¼ãƒ€ãƒ«èƒŒæ™¯ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¦é–‰ã˜ã‚‹
window.addEventListener('click', function(event) {
	const modal = document.getElementById('imageModal');
	if (event.target === modal) {
		const scene = document.querySelector('a-scene');
		
		// ãƒ–ãƒ©ãƒ¼ã‚¨ãƒ•ã‚§ã‚¯ãƒˆã‚’å‰Šé™¤
		scene.classList.remove('modal-blur');
		
		// ãƒ¢ãƒ¼ãƒ€ãƒ«ã‚’é–‰ã˜ã‚‹
		modal.style.display = 'none';
		modal.classList.remove('show');
	}
});



document.getElementById('showInfoCount').addEventListener('change', function() {
	updateStatus(); // ä½œå“æ•°è¡¨ç¤ºè¨­å®šãŒå¤‰æ›´ã•ã‚ŒãŸã‚‰ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã‚’æ›´æ–°
});

function escapeHtml(text) {
    const div = document.createElement('div');
    div.textContent = text;
    return div.innerHTML;
}

imageTitle.innerHTML = escapeHtml(info.title);
</script>
</body>
</html>